{"version":3,"file":"bundle.js","sources":["../src/ratelimit.ts","../src/types.ts","../src/utils.ts","../src/get.ts","../src/update.ts","../src/append.ts","../src/delete.ts","../src/index.ts"],"sourcesContent":["/**\n * Exponential backoff handler for Google Sheets API calls\n * Handles rate limiting (429) and quota exceeded errors\n * @param fn Function to execute with retry logic\n * @param retries Maximum number of retry attempts (default: 16)\n * @returns Result of the function execution\n */\nexport function callHandler<T>(fn: () => T, retries: number = 16): T {\n  let attempt = 0;\n\n  while (attempt < retries) {\n    try {\n      return fn();\n    } catch (error: any) {\n      const errorMessage = error?.message || String(error);\n      \n      // Check if it's a rate limit or quota error\n      const isRateLimitError = \n        errorMessage.includes(\"429\") ||\n        errorMessage.includes(\"Quota exceeded\") ||\n        errorMessage.includes(\"Rate Limit Exceeded\");\n      \n      if (isRateLimitError) {\n        attempt++;\n        \n        if (attempt >= retries) {\n          throw new Error(\n            `Max retries (${retries}) reached for Google Sheets API call. Last error: ${errorMessage}`\n          );\n        }\n        \n        // Exponential backoff with jitter, capped at 64 seconds\n        const backoffDelay = Math.min(\n          Math.pow(2, attempt) * 1000 + Math.random() * 1000,\n          64000\n        );\n        \n        console.log(`Rate limit hit, retrying in ${Math.round(backoffDelay)}ms (attempt ${attempt}/${retries})`);\n        Utilities.sleep(backoffDelay);\n      } else {\n        // Not a rate limit error, rethrow immediately\n        throw error;\n      }\n    }\n  }\n\n  throw new Error(\"Unexpected state: Max retries reached without throwing error\");\n}\n","/**\n * Options for reading data from Google Sheets\n */\nexport type GQueryReadOptions = {\n  /** How values should be rendered in the output */\n  valueRenderOption?: ValueRenderOption;\n  /** How dates and times should be rendered in the output */\n  dateTimeRenderOption?: DateTimeRenderOption;\n};\n\n/**\n * Result structure returned by GQuery operations\n */\nexport type GQueryResult = {\n  /** Array of row objects */\n  rows: GQueryRow[];\n  /** Column headers from the sheet */\n  headers: string[];\n};\n\n/**\n * A single row with metadata about its position in the sheet\n */\nexport type GQueryRow = Record<string, any> & {\n  __meta: {\n    /** 1-based row number in the sheet (row 1 is headers) */\n    rowNum: number;\n    /** Number of columns in the row */\n    colLength: number;\n  };\n};\n\n/**\n * How values should be rendered in the output\n * @see https://developers.google.com/sheets/api/reference/rest/v4/ValueRenderOption\n */\nexport enum ValueRenderOption {\n  /** Values will be calculated and formatted according to cell formatting */\n  FORMATTED_VALUE = \"FORMATTED_VALUE\",\n  /** Values will be calculated but not formatted */\n  UNFORMATTED_VALUE = \"UNFORMATTED_VALUE\",\n  /** Values will not be calculated; formulas will be returned as-is */\n  FORMULA = \"FORMULA\",\n}\n\n/**\n * How dates and times should be rendered in the output\n * @see https://developers.google.com/sheets/api/reference/rest/v4/DateTimeRenderOption\n */\nexport enum DateTimeRenderOption {\n  /** Dates and times will be rendered as strings according to cell formatting */\n  FORMATTED_STRING = \"FORMATTED_STRING\",\n  /** Dates and times will be rendered as serial numbers */\n  SERIAL_NUMBER = \"SERIAL_NUMBER\",\n}\n","import { callHandler } from \"./ratelimit\";\nimport { GQueryRow } from \"./types\";\n\n/**\n * Parse raw sheet values into GQueryRow objects with metadata\n * @param headers Column headers from the sheet\n * @param values Raw values from the sheet (without header row)\n * @returns Array of GQueryRow objects\n */\nexport function parseRows(\n  headers: string[],\n  values: any[][]\n): GQueryRow[] {\n  return values.map((row, rowIndex) => {\n    const obj: GQueryRow = {\n      __meta: {\n        rowNum: rowIndex + 2, // +2 because header is row 1, data starts at row 2\n        colLength: headers.length,\n      },\n    } as GQueryRow;\n\n    headers.forEach((header: string, i: number) => {\n      obj[header] = row[i] !== undefined ? row[i] : \"\";\n    });\n\n    return obj;\n  });\n}\n\n/**\n * Fetch all data from a sheet including headers\n * @param spreadsheetId The ID of the spreadsheet\n * @param sheetName The name of the sheet to fetch\n * @returns Object containing headers and rows\n */\nexport function fetchSheetData(\n  spreadsheetId: string,\n  sheetName: string\n): { headers: string[]; rows: GQueryRow[] } {\n  const response = callHandler(() =>\n    Sheets.Spreadsheets.Values.get(spreadsheetId, sheetName)\n  );\n  \n  const values = response.values || [];\n\n  if (values.length === 0) {\n    return { headers: [], rows: [] };\n  }\n\n  const headers = values[0].map((h: any) => String(h));\n  const rows = parseRows(headers, values.slice(1));\n\n  return { headers, rows };\n}\n","import { GQuery, GQueryTable, GQueryTableFactory } from \"./index\";\nimport { callHandler } from \"./ratelimit\";\nimport {\n  GQueryReadOptions,\n  GQueryResult,\n  ValueRenderOption,\n  DateTimeRenderOption,\n  GQueryRow,\n} from \"./types\";\nimport { parseRows } from \"./utils\";\n\n/**\n * Convert row values to appropriate types (boolean, date, number)\n * Optimized to reduce redundant type checking\n */\nfunction convertRowTypes(row: GQueryRow, headers: string[]): GQueryRow {\n  const newRow: GQueryRow = { __meta: row.__meta };\n  \n  headers.forEach((header) => {\n    let value = row[header];\n    \n    // Skip empty values\n    if (value === undefined || value === null || value === \"\") {\n      newRow[header] = value;\n      return;\n    }\n    \n    // Only process string values for type conversion\n    if (typeof value === \"string\") {\n      const lowerValue = value.toLowerCase();\n      \n      // Check for boolean\n      if (lowerValue === \"true\" || lowerValue === \"false\") {\n        newRow[header] = lowerValue === \"true\";\n        return;\n      }\n      \n      // Check for date pattern (MM/DD/YYYY or MM/DD/YYYY HH:MM:SS)\n      if (/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}(\\s\\d{1,2}:\\d{1,2}(:\\d{1,2})?)?$/.test(value)) {\n        const dateValue = new Date(value);\n        if (!isNaN(dateValue.getTime())) {\n          newRow[header] = dateValue;\n          return;\n        }\n      }\n    }\n    \n    // Keep original value if no conversion applied\n    newRow[header] = value;\n  });\n  \n  return newRow;\n}\n\nexport function getManyInternal(\n  gquery: GQuery,\n  sheetNames: string[],\n  options?: GQueryReadOptions\n): {\n  [sheetName: string]: GQueryResult;\n} {\n  if (!sheetNames || sheetNames.length === 0) {\n    return {};\n  }\n\n  const valueRenderOption =\n    options?.valueRenderOption || ValueRenderOption.FORMATTED_VALUE;\n  const dateTimeRenderOption =\n    options?.dateTimeRenderOption || DateTimeRenderOption.FORMATTED_STRING;\n\n  const result: { [sheetName: string]: GQueryResult } = {};\n\n  // Fetch data using batchGet for better performance\n  const dataResponse = callHandler(() =>\n    Sheets.Spreadsheets.Values.batchGet(gquery.spreadsheetId, {\n      ranges: sheetNames,\n      valueRenderOption,\n      dateTimeRenderOption,\n    })\n  );\n\n  if (!dataResponse || !dataResponse.valueRanges) {\n    sheetNames.forEach((sheet) => {\n      result[sheet] = { headers: [], rows: [] };\n    });\n    return result;\n  }\n\n  dataResponse.valueRanges.forEach((valueRange, index) => {\n    const sheetName = sheetNames[index];\n\n    if (!valueRange.values || valueRange.values.length === 0) {\n      result[sheetName] = { headers: [], rows: [] };\n      return;\n    }\n\n    const headers = valueRange.values[0].map((h) => String(h));\n    let rows = parseRows(headers, valueRange.values.slice(1));\n\n    // Apply type conversion to rows\n    rows = rows.map((row) => convertRowTypes(row, headers));\n\n    result[sheetName] = { headers, rows };\n  });\n\n  return result;\n}\n\nexport function getInternal(\n  gqueryTableFactory: GQueryTableFactory,\n  options?: GQueryReadOptions\n): GQueryResult {\n  const gqueryTable = gqueryTableFactory.gQueryTable;\n  const gquery = gqueryTable.gquery;\n  // Determine which sheets we need to read from\n  const sheetsToRead = [gqueryTable.sheetName];\n\n  // Add all join sheets\n  if (gqueryTableFactory.joinOption.length > 0) {\n    gqueryTableFactory.joinOption.forEach((join) => {\n      if (!sheetsToRead.includes(join.sheetName)) {\n        sheetsToRead.push(join.sheetName);\n      }\n    });\n  }\n\n  // Read data from all required sheets at once\n  const results = gquery.getMany(sheetsToRead, options);\n\n  // If the main sheet doesn't exist or has no data\n  if (\n    !results[gqueryTable.sheetName] ||\n    results[gqueryTable.sheetName].rows.length === 0\n  ) {\n    return { headers: [], rows: [] };\n  }\n\n  // Get data for the primary table\n  let result = results[gqueryTable.sheetName];\n  let rows = result.rows;\n  let headers = result.headers;\n\n  // Process each join sequentially\n  if (gqueryTableFactory.joinOption.length > 0) {\n    gqueryTableFactory.joinOption.forEach((joinConfig) => {\n      const { sheetName, sheetColumn, joinColumn, columnsToReturn } =\n        joinConfig;\n\n      const joinData = results[sheetName];\n\n      if (!joinData || !joinData.rows || joinData.rows.length === 0) {\n        return; // Skip this join\n      }\n\n      // Create join lookup table\n      const joinMap: Record<string, any[]> = {};\n\n      // Check if the join column exists in the join table\n      const joinHeaders = joinData.headers;\n      if (!joinHeaders.includes(sheetColumn)) {\n        return; // Skip this join\n      }\n\n      joinData.rows.forEach((joinRow) => {\n        const joinKey = String(joinRow[sheetColumn]);\n        if (!joinMap[joinKey]) {\n          joinMap[joinKey] = [];\n        }\n        joinMap[joinKey].push(joinRow);\n      });\n\n      // Perform the join operation\n      rows = rows.map((row) => {\n        const localJoinValue = row[joinColumn];\n        const joinedRows = joinMap[String(localJoinValue)] || [];\n\n        // Create joined row with all join table fields\n        const joinedRow = { ...row };\n\n        joinedRows.forEach((joinRow, index) => {\n          // Determine which columns to include from join\n          const columnsToInclude =\n            columnsToReturn ||\n            Object.keys(joinRow).filter(\n              (key) => key !== \"__meta\" && key !== sheetColumn\n            );\n\n          columnsToInclude.forEach((key) => {\n            if (joinRow.hasOwnProperty(key) && key !== \"__meta\") {\n              // For multiple joined rows, add suffix _1, _2, etc.\n              const suffix = joinedRows.length > 1 ? `_${index + 1}` : \"\";\n              const targetKey = key === sheetColumn ? key : `${key}${suffix}`;\n              joinedRow[targetKey] = joinRow[key];\n            }\n          });\n        });\n\n        return joinedRow;\n      });\n    });\n  }\n\n  // Apply filter if specified\n  if (gqueryTableFactory.filterOption) {\n    rows = rows.filter(gqueryTableFactory.filterOption);\n  }\n\n  // Apply select if specified\n  if (\n    gqueryTableFactory.selectOption &&\n    gqueryTableFactory.selectOption.length > 0\n  ) {\n    // Create a map to track columns from joined tables\n    const joinedColumns = new Set<string>();\n\n    // Collect all columns from joined tables\n    rows.forEach((row) => {\n      Object.keys(row).forEach((key) => {\n        // If the column is not in the original headers, it's from a join\n        if (!headers.includes(key) && key !== \"__meta\") {\n          joinedColumns.add(key);\n        }\n      });\n    });\n\n    // If we have a select option, determine which columns to keep\n    let selectedHeaders: string[];\n\n    // Check if any of the selected headers is \"Model\" or \"Model_Name\"\n    // If we're selecting the join columns, we want to include all related joined fields\n    if (\n      gqueryTableFactory.selectOption.some(\n        (header) =>\n          header === \"Model\" ||\n          header === \"Model_Name\" ||\n          gqueryTableFactory.joinOption.some(\n            (j) => j.joinColumn === header || j.sheetColumn === header\n          )\n      )\n    ) {\n      // Include all join-related columns and the selected columns\n      selectedHeaders = [...gqueryTableFactory.selectOption];\n      joinedColumns.forEach((joinCol) => {\n        selectedHeaders.push(joinCol);\n      });\n    } else {\n      // Otherwise only include explicitly selected columns\n      selectedHeaders = [...gqueryTableFactory.selectOption];\n    }\n\n    // Remove duplicates\n    selectedHeaders = [...new Set(selectedHeaders)];\n\n    // Filter rows to only include selected columns\n    rows = rows.map((row) => {\n      const selectedRow: GQueryRow = {\n        __meta: row.__meta,\n      };\n\n      selectedHeaders.forEach((header) => {\n        if (row.hasOwnProperty(header)) {\n          selectedRow[header] = row[header];\n        }\n      });\n\n      return selectedRow;\n    });\n\n    // Update headers to include both selected and joined columns\n    return {\n      headers: selectedHeaders,\n      rows,\n    };\n  }\n\n  return {\n    headers,\n    rows,\n  };\n}\n\nexport function queryInternal(\n  gqueryTable: GQueryTable,\n  query: string\n): GQueryResult {\n  const sheet = gqueryTable.sheet;\n  const range = sheet.getDataRange();\n  \n  // Build column name to letter mapping\n  let replaced = query;\n  const lastColumn = range.getLastColumn();\n  \n  for (let i = 0; i < lastColumn; i++) {\n    const rng = sheet.getRange(1, i + 1);\n    const name = rng.getValue();\n    const letter = rng.getA1Notation().match(/([A-Z]+)/)?.[0];\n    \n    if (letter && name) {\n      replaced = replaced.replaceAll(name, letter);\n    }\n  }\n\n  // Build query URL\n  const url = Utilities.formatString(\n    \"https://docs.google.com/spreadsheets/d/%s/gviz/tq?tq=%s&sheet=%s%s&headers=1\",\n    sheet.getParent().getId(),\n    encodeURIComponent(replaced),\n    sheet.getName(),\n    typeof range === \"string\" ? \"&range=\" + range : \"\"\n  );\n\n  // Fetch with authorization\n  const response = UrlFetchApp.fetch(url, {\n    headers: {\n      Authorization: \"Bearer \" + ScriptApp.getOAuthToken(),\n    },\n  });\n\n  // Parse response\n  const jsonResponse = JSON.parse(\n    response\n      .getContentText()\n      .replace(\"/*O_o*/\\n\", \"\")\n      .replace(/(google\\.visualization\\.Query\\.setResponse\\()|(\\);)/gm, \"\")\n  );\n  \n  const table = jsonResponse.table;\n\n  // Extract column headers\n  const headers = table.cols.map((col: any) => col.label);\n\n  // Map rows to proper GQueryRow format\n  const rows = table.rows.map((row: any) => {\n    const rowObj: GQueryRow = {\n      __meta: {\n        rowNum: -1, // Query results don't have reliable row numbers\n        colLength: row.c.length,\n      },\n    };\n\n    // Populate row data\n    table.cols.forEach((col: any, colIndex: number) => {\n      const cellData = row.c[colIndex];\n      let value: any = \"\";\n      \n      if (cellData) {\n        // Use formatted value if available, otherwise use raw value\n        value = cellData.f !== null && cellData.f !== undefined\n          ? cellData.f\n          : cellData.v;\n\n        // Convert date strings if needed\n        if (typeof value === \"string\" && \n            /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}(\\s\\d{1,2}:\\d{1,2}(:\\d{1,2})?)?$/.test(value)) {\n          const dateValue = new Date(value);\n          if (!isNaN(dateValue.getTime())) {\n            value = dateValue;\n          }\n        }\n      }\n      \n      rowObj[col.label] = value;\n    });\n\n    return rowObj;\n  });\n\n  return {\n    headers,\n    rows,\n  };\n}\n","import { GQueryTableFactory } from \"./index\";\nimport { callHandler } from \"./ratelimit\";\nimport { GQueryResult, GQueryRow } from \"./types\";\nimport { fetchSheetData } from \"./utils\";\n\nexport function updateInternal(\n  gQueryTableFactory: GQueryTableFactory,\n  updateFn: (row: Record<string, any>) => Record<string, any>\n): GQueryResult {\n  const spreadsheetId = gQueryTableFactory.gQueryTable.spreadsheetId;\n  const sheetName = gQueryTableFactory.gQueryTable.sheetName;\n  const range = sheetName;\n\n  const { headers, rows } = fetchSheetData(spreadsheetId, range);\n\n  if (headers.length === 0) {\n    return { rows: [], headers: [] };\n  }\n\n  // Filter rows if filter is specified\n  const filteredRows = gQueryTableFactory.filterOption\n    ? rows.filter((row) => {\n        try {\n          return gQueryTableFactory.filterOption!(row);\n        } catch (error) {\n          console.error(\"Error filtering row:\", error);\n          return false;\n        }\n      })\n    : rows;\n\n  // Apply updates to filtered rows\n  const updatedRows: GQueryRow[] = filteredRows.map((row) => {\n    const updatedRow: GQueryRow = { ...row };\n    try {\n      const result = updateFn(updatedRow);\n      if (result && typeof result === \"object\") {\n        Object.assign(updatedRow, result);\n      }\n    } catch (error) {\n      console.error(\"Error updating row:\", error);\n    }\n    return updatedRow;\n  });\n\n  // Collect changed cells\n  const changedCells = new Map<string, any[]>();\n\n  updatedRows.forEach((updatedRow) => {\n    const rowIndex = updatedRow.__meta.rowNum - 2;\n    const originalRow = rows[rowIndex];\n\n    headers.forEach((header, columnIndex) => {\n      let updatedValue = updatedRow[header];\n      const originalValue = originalRow[header];\n\n      // Convert dates to locale string for comparison\n      if (updatedValue instanceof Date) {\n        updatedValue = updatedValue.toLocaleString();\n      }\n\n      // Skip if values are the same\n      if (originalValue === updatedValue) return;\n\n      // Only update if value changed or is being set/cleared\n      if (updatedValue !== undefined && updatedValue !== null) {\n        const columnLetter = getColumnLetter(columnIndex);\n        const cellRange = `${sheetName}!${columnLetter}${updatedRow.__meta.rowNum}`;\n        changedCells.set(cellRange, [[updatedValue]]);\n      } else if (originalValue !== undefined && originalValue !== null) {\n        const columnLetter = getColumnLetter(columnIndex);\n        const cellRange = `${sheetName}!${columnLetter}${updatedRow.__meta.rowNum}`;\n        changedCells.set(cellRange, [[updatedValue || \"\"]]);\n      }\n    });\n  });\n\n  // Perform batch update if there are changes\n  if (changedCells.size > 0) {\n    const optimizedUpdates = optimizeRanges(changedCells);\n\n    const batchUpdateRequest = {\n      data: optimizedUpdates,\n      valueInputOption: \"USER_ENTERED\",\n    };\n\n    callHandler(() =>\n      Sheets.Spreadsheets.Values.batchUpdate(batchUpdateRequest, spreadsheetId)\n    );\n  }\n\n  return {\n    rows: filteredRows.length > 0 ? updatedRows : [],\n    headers,\n  };\n}\n\n/**\n * Convert column index to column letter (0 -> A, 1 -> B, etc.)\n */\nfunction getColumnLetter(columnIndex: number): string {\n  let columnLetter = \"\";\n  let index = columnIndex;\n\n  while (index >= 0) {\n    columnLetter = String.fromCharCode(65 + (index % 26)) + columnLetter;\n    index = Math.floor(index / 26) - 1;\n  }\n\n  return columnLetter;\n}\n\n/**\n * Optimize update ranges by combining adjacent cells in the same column\n * into contiguous row segments.\n */\nfunction optimizeRanges(\n  changedCells: Map<string, any[]>\n): { range: string; values: any[][] }[] {\n  const columnGroups = new Map<string, Map<number, any>>();\n\n  for (const [cellRange, value] of changedCells.entries()) {\n    const matches = cellRange.match(/([^!]+)!([A-Z]+)(\\d+)$/);\n    if (!matches) continue;\n\n    const sheet = matches[1];\n    const columnLetter = matches[2];\n    const rowNumber = parseInt(matches[3], 10);\n    const columnKey = `${sheet}!${columnLetter}`;\n\n    if (!columnGroups.has(columnKey)) {\n      columnGroups.set(columnKey, new Map());\n    }\n    columnGroups.get(columnKey)!.set(rowNumber, value[0][0]);\n  }\n\n  const optimizedUpdates: { range: string; values: any[][] }[] = [];\n\n  for (const [columnKey, rowsMap] of columnGroups.entries()) {\n    const rowNumbers = Array.from(rowsMap.keys()).sort((a, b) => a - b);\n    if (rowNumbers.length === 0) continue;\n\n    const [sheet, column] = columnKey.split(\"!\");\n\n    let start = rowNumbers[0];\n    let groupValues: any[][] = [[rowsMap.get(start)]];\n\n    for (let i = 1; i < rowNumbers.length; i++) {\n      const rowNum = rowNumbers[i];\n      const prev = rowNumbers[i - 1];\n      if (rowNum === prev + 1) {\n        groupValues.push([rowsMap.get(rowNum)]);\n      } else {\n        const end = prev;\n        const rangeKey =\n          start === end\n            ? `${sheet}!${column}${start}`\n            : `${sheet}!${column}${start}:${column}${end}`;\n        optimizedUpdates.push({ range: rangeKey, values: groupValues });\n        start = rowNum;\n        groupValues = [[rowsMap.get(rowNum)]];\n      }\n    }\n\n    const last = rowNumbers[rowNumbers.length - 1];\n    const rangeKey =\n      start === last\n        ? `${sheet}!${column}${start}`\n        : `${sheet}!${column}${start}:${column}${last}`;\n    optimizedUpdates.push({ range: rangeKey, values: groupValues });\n  }\n\n  return optimizedUpdates;\n}\n","import { GQueryTable } from \"./index\";\nimport { callHandler } from \"./ratelimit\";\nimport { GQueryResult, GQueryRow } from \"./types\";\n\nexport function appendInternal(\n  table: GQueryTable,\n  data: { [key: string]: any }[]\n): GQueryResult {\n  // Validate input data\n  if (!data || data.length === 0) {\n    return { rows: [], headers: [] };\n  }\n\n  const spreadsheetId = table.spreadsheetId;\n  const sheetName = table.sheetName;\n\n  // Fetch headers from the first row\n  const response = callHandler(() =>\n    Sheets.Spreadsheets.Values.get(spreadsheetId, `${sheetName}!1:1`)\n  );\n\n  // Validate sheet exists and has headers\n  if (!response || !response.values || response.values.length === 0) {\n    throw new Error(`Sheet \"${sheetName}\" not found or has no headers`);\n  }\n\n  const headers = response.values[0].map((header) => String(header));\n\n  // Map data to rows according to header order\n  const rowsToAppend = data.map((item) => {\n    return headers.map((header) => {\n      let value = item[header];\n\n      // Convert Date objects to locale strings\n      if (value instanceof Date) {\n        value = value.toLocaleString();\n      }\n\n      return value !== undefined ? value : \"\";\n    });\n  });\n\n  // Append data using Sheets API\n  const appendResponse = callHandler(() =>\n    Sheets.Spreadsheets.Values.append(\n      { values: rowsToAppend },\n      spreadsheetId,\n      sheetName,\n      {\n        valueInputOption: \"USER_ENTERED\",\n        insertDataOption: \"OVERWRITE\",\n        responseValueRenderOption: \"FORMATTED_VALUE\",\n        responseDateTimeRenderOption: \"FORMATTED_STRING\",\n        includeValuesInResponse: true,\n      }\n    )\n  );\n\n  // Validate append was successful\n  if (\n    !appendResponse ||\n    !appendResponse.updates ||\n    !appendResponse.updates.updatedRange\n  ) {\n    throw new Error(\"Failed to append data to sheet\");\n  }\n\n  // Parse the updated range to get row numbers\n  const updatedRange = appendResponse.updates.updatedRange;\n  const rangeMatch = updatedRange.match(/([^!]+)!([A-Z]+)(\\d+):([A-Z]+)(\\d+)/);\n\n  if (!rangeMatch) {\n    throw new Error(`Could not parse updated range: ${updatedRange}`);\n  }\n\n  const startRow = parseInt(rangeMatch[3], 10);\n  const endRow = parseInt(rangeMatch[5], 10);\n  \n  // Validate that all rows were appended\n  const expectedRowCount = data.length;\n  const actualRowCount = endRow - startRow + 1;\n  if (actualRowCount !== expectedRowCount) {\n    console.warn(\n      `Expected to append ${expectedRowCount} rows but ${actualRowCount} were appended`\n    );\n  }\n\n  // Create result rows with metadata\n  const resultRows: GQueryRow[] = rowsToAppend.map((row, index) => {\n    const rowObj: GQueryRow = {\n      __meta: {\n        rowNum: startRow + index,\n        colLength: headers.length,\n      },\n    };\n\n    // Map values to header names\n    headers.forEach((header, colIndex) => {\n      rowObj[header] = row[colIndex];\n    });\n\n    return rowObj;\n  });\n\n  return {\n    rows: resultRows,\n    headers,\n  };\n}\n","import { GQueryTableFactory } from \"./index\";\nimport { callHandler } from \"./ratelimit\";\nimport { fetchSheetData } from \"./utils\";\n\nexport function deleteInternal(gqueryTableFactory: GQueryTableFactory): {\n  deletedRows: number;\n} {\n  const spreadsheetId = gqueryTableFactory.gQueryTable.spreadsheetId;\n  const sheetName = gqueryTableFactory.gQueryTable.sheetName;\n  const sheet = gqueryTableFactory.gQueryTable.sheet;\n  const sheetId = sheet.getSheetId();\n\n  const { rows } = fetchSheetData(spreadsheetId, sheetName);\n\n  // Check if filter is specified and rows exist\n  if (!gqueryTableFactory.filterOption || rows.length === 0) {\n    return { deletedRows: 0 };\n  }\n\n  // Find rows matching the filter condition\n  const rowsToDelete = rows.filter((row) => {\n    try {\n      return gqueryTableFactory.filterOption(row);\n    } catch (error) {\n      console.error(\"Error filtering row:\", error);\n      return false;\n    }\n  });\n\n  if (rowsToDelete.length === 0) {\n    return { deletedRows: 0 };\n  }\n\n  // Sort in descending order to avoid row number shifting issues\n  rowsToDelete.sort((a, b) => b.__meta.rowNum - a.__meta.rowNum);\n\n  // Build batch delete request\n  const batchUpdateRequest = {\n    requests: rowsToDelete.map((row) => ({\n      deleteDimension: {\n        range: {\n          sheetId,\n          dimension: \"ROWS\",\n          startIndex: row.__meta.rowNum - 1, // Convert to 0-based index\n          endIndex: row.__meta.rowNum, // End-exclusive range\n        },\n      },\n    })),\n  };\n\n  // Execute batch delete\n  try {\n    callHandler(() =>\n      Sheets.Spreadsheets.batchUpdate(batchUpdateRequest, spreadsheetId)\n    );\n    return { deletedRows: rowsToDelete.length };\n  } catch (error) {\n    console.error(\"Error deleting rows:\", error);\n    throw new Error(`Failed to delete rows: ${error}`);\n  }\n}\n","import { getInternal, getManyInternal, queryInternal } from \"./get\";\nimport { updateInternal } from \"./update\";\nimport { appendInternal } from \"./append\";\nimport { deleteInternal } from \"./delete\";\nimport { GQueryReadOptions, GQueryResult } from \"./types\";\n\nexport * from \"./types\";\n\n/**\n * Main GQuery class for interacting with Google Sheets\n * Provides a query-like interface for reading and writing spreadsheet data\n */\nexport class GQuery {\n  spreadsheetId: string;\n\n  /**\n   * Create a new GQuery instance\n   * @param spreadsheetId Optional spreadsheet ID. If not provided, uses the active spreadsheet\n   */\n  constructor(spreadsheetId?: string) {\n    this.spreadsheetId = spreadsheetId\n      ? spreadsheetId\n      : SpreadsheetApp.getActiveSpreadsheet().getId();\n  }\n\n  /**\n   * Get a table reference for a specific sheet\n   * @param sheetName Name of the sheet\n   * @returns GQueryTable instance for chaining operations\n   */\n  from(sheetName: string): GQueryTable {\n    return new GQueryTable(this, this.spreadsheetId, sheetName);\n  }\n\n  /**\n   * Efficiently fetch data from multiple sheets at once\n   * @param sheetNames Array of sheet names to fetch\n   * @param options Optional rendering options\n   * @returns Object mapping sheet names to their data\n   */\n  getMany(\n    sheetNames: string[],\n    options?: GQueryReadOptions\n  ): {\n    [sheetName: string]: GQueryResult;\n  } {\n    return getManyInternal(this, sheetNames, options);\n  }\n}\n\n/**\n * Represents a single sheet table for query operations\n */\nexport class GQueryTable {\n  gquery: GQuery;\n  spreadsheetId: string;\n  spreadsheet: GoogleAppsScript.Spreadsheet.Spreadsheet;\n  sheetName: string;\n  sheet: GoogleAppsScript.Spreadsheet.Sheet;\n\n  constructor(gquery: GQuery, spreadsheetId: string, sheetName: string) {\n    this.spreadsheetId = spreadsheetId;\n    this.sheetName = sheetName;\n    this.spreadsheet = SpreadsheetApp.openById(spreadsheetId);\n    this.sheet = this.spreadsheet.getSheetByName(sheetName);\n    this.gquery = gquery;\n  }\n\n  /**\n   * Select specific columns to return\n   * @param headers Array of column names to select\n   * @returns GQueryTableFactory for chaining\n   */\n  select(headers: string[]): GQueryTableFactory {\n    return new GQueryTableFactory(this).select(headers);\n  }\n\n  /**\n   * Filter rows based on a condition\n   * @param filterFn Function that returns true for rows to include\n   * @returns GQueryTableFactory for chaining\n   */\n  where(filterFn: (row: any) => boolean): GQueryTableFactory {\n    return new GQueryTableFactory(this).where(filterFn);\n  }\n\n  /**\n   * Join with another sheet\n   * @param sheetName Name of sheet to join with\n   * @param sheetColumn Column in the joined sheet to match on\n   * @param joinColumn Column in this sheet to match on\n   * @param columnsToReturn Optional array of columns to return from joined sheet\n   * @returns GQueryTableFactory for chaining\n   */\n  join(\n    sheetName: string,\n    sheetColumn: string,\n    joinColumn: string,\n    columnsToReturn?: string[]\n  ): GQueryTableFactory {\n    return new GQueryTableFactory(this).join(\n      sheetName,\n      sheetColumn,\n      joinColumn,\n      columnsToReturn\n    );\n  }\n\n  /**\n   * Update rows in the sheet\n   * @param updateFn Function that receives a row and returns updated values\n   * @returns GQueryResult with updated rows\n   */\n  update(\n    updateFn: (row: Record<string, any>) => Record<string, any>\n  ): GQueryResult {\n    return new GQueryTableFactory(this).update(updateFn);\n  }\n\n  /**\n   * Append new rows to the sheet\n   * @param data Single object or array of objects to append\n   * @returns GQueryResult with appended rows\n   */\n  append(\n    data: { [key: string]: any }[] | { [key: string]: any }\n  ): GQueryResult {\n    const dataArray = Array.isArray(data) ? data : [data];\n    return appendInternal(this, dataArray);\n  }\n\n  /**\n   * Get data from the sheet\n   * @param options Optional rendering options\n   * @returns GQueryResult with rows and headers\n   */\n  get(options?: GQueryReadOptions): GQueryResult {\n    return new GQueryTableFactory(this).get(options);\n  }\n\n  /**\n   * Execute a Google Visualization API query\n   * @param query Query string in Google Query Language\n   * @returns GQueryResult with query results\n   */\n  query(query: string): GQueryResult {\n    return queryInternal(this, query);\n  }\n\n  /**\n   * Delete rows from the sheet\n   * @returns Object with count of deleted rows\n   */\n  delete(): { deletedRows: number } {\n    return new GQueryTableFactory(this).delete();\n  }\n}\n\n/**\n * Factory class for building and executing queries with filters and joins\n */\nexport class GQueryTableFactory {\n  gQueryTable: GQueryTable;\n  selectOption?: string[];\n  filterOption?: (row: any) => boolean;\n  joinOption: {\n    sheetName: string;\n    sheetColumn: string;\n    joinColumn: string;\n    columnsToReturn?: string[];\n  }[] = [];\n\n  constructor(GQueryTable: GQueryTable) {\n    this.gQueryTable = GQueryTable;\n  }\n\n  select(headers: string[]): GQueryTableFactory {\n    this.selectOption = headers;\n    return this;\n  }\n\n  where(filterFn: (row: any) => boolean): GQueryTableFactory {\n    this.filterOption = filterFn;\n    return this;\n  }\n\n  join(\n    sheetName: string,\n    sheetColumn: string,\n    joinColumn: string,\n    columnsToReturn?: string[]\n  ): GQueryTableFactory {\n    this.joinOption.push({\n      sheetName,\n      sheetColumn,\n      joinColumn,\n      columnsToReturn,\n    });\n    return this;\n  }\n\n  get(options?: GQueryReadOptions): GQueryResult {\n    return getInternal(this, options);\n  }\n\n  update(\n    updateFn: (row: Record<string, any>) => Record<string, any>\n  ): GQueryResult {\n    return updateInternal(this, updateFn);\n  }\n\n  append(\n    data: { [key: string]: any }[] | { [key: string]: any }\n  ): GQueryResult {\n    const dataArray = Array.isArray(data) ? data : [data];\n    return appendInternal(this.gQueryTable, dataArray);\n  }\n\n  delete(): { deletedRows: number } {\n    return deleteInternal(this);\n  }\n}\n"],"names":[],"mappings":"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"}