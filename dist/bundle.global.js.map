{"version":3,"file":"bundle.global.js","sources":["../src/index.ts"],"sourcesContent":["export class GQuery {\r\n  spreadsheetId: string;\r\n\r\n  constructor(spreadsheetId?: string) {\r\n    this.spreadsheetId = spreadsheetId\r\n      ? spreadsheetId\r\n      : SpreadsheetApp.getActiveSpreadsheet().getId();\r\n  }\r\n\r\n  from(sheetName: string): GQueryTable {\r\n    return new GQueryTable(this.spreadsheetId, sheetName);\r\n  }\r\n\r\n  getMany(\r\n    sheetNames: string[],\r\n    options?: GQueryReadOptions\r\n  ): {\r\n    [sheetName: string]: GQueryResult;\r\n  } {\r\n    if (!sheetNames || sheetNames.length === 0) {\r\n      return {};\r\n    }\r\n\r\n    // Set default options if not provided\r\n    const valueRenderOption =\r\n      options?.valueRenderOption || ValueRenderOption.FORMATTED_VALUE;\r\n    const dateTimeRenderOption =\r\n      options?.dateTimeRenderOption || DateTimeRenderOption.FORMATTED_STRING;\r\n\r\n    // Use Sheets API to batch get the data\r\n    const response = Sheets.Spreadsheets.Values.batchGet(this.spreadsheetId, {\r\n      ranges: sheetNames,\r\n      valueRenderOption: valueRenderOption,\r\n      dateTimeRenderOption: dateTimeRenderOption,\r\n    });\r\n\r\n    const result: { [sheetName: string]: GQueryResult } = {};\r\n\r\n    if (!response || !response.valueRanges) {\r\n      return result;\r\n    }\r\n\r\n    // Process each returned value range\r\n    response.valueRanges.forEach((valueRange, index) => {\r\n      const sheetName = sheetNames[index];\r\n\r\n      if (!valueRange.values || valueRange.values.length === 0) {\r\n        // Handle empty sheet\r\n        result[sheetName] = { headers: [], rows: [] };\r\n        return;\r\n      }\r\n\r\n      // First row contains headers\r\n      const headers = valueRange.values[0].map((header) => String(header));\r\n      const rows: GQueryRow[] = [];\r\n\r\n      // Process data rows (starting from index 1 to skip headers)\r\n      for (let i = 1; i < valueRange.values.length; i++) {\r\n        const rowData = valueRange.values[i];\r\n        const row: GQueryRow = {\r\n          __meta: {\r\n            rowNum: i + 1, // 1-based row number (+1 because we're starting from index 1)\r\n            colLength: rowData.length,\r\n          },\r\n        };\r\n\r\n        // Map each column value to its corresponding header\r\n        for (let j = 0; j < headers.length; j++) {\r\n          const header = headers[j];\r\n          row[header] = j < rowData.length ? rowData[j] : null;\r\n        }\r\n\r\n        rows.push(row);\r\n      }\r\n\r\n      result[sheetName] = { headers, rows };\r\n    });\r\n\r\n    return result;\r\n  }\r\n}\r\n/**\r\n * Idea end result:\r\n * user calls from(\"Sheet1\")\r\n * if user calls .select([\"Id\", \"Name\"]) -- only return Id Name columns after read() is called\r\n * if user calls .filter((row) => row.Id === 1) -- only return rows where Id === 1 after read() is called\r\n * if user calls .join(\"Models\", \"Model\", \"Model_Name\") -- join Models sheet on Model_Name (Models sheet) and Model (current sheet)\r\n * once read() is called, it will return the result of the query\r\n */\r\nexport class GQueryTable {\r\n  spreadsheetId: string;\r\n  spreadsheet: GoogleAppsScript.Spreadsheet.Spreadsheet;\r\n  sheetName: string;\r\n  sheet: GoogleAppsScript.Spreadsheet.Sheet;\r\n\r\n  constructor(spreadsheetId: string, sheetName: string) {\r\n    this.spreadsheetId = spreadsheetId;\r\n    this.sheetName = sheetName;\r\n    this.spreadsheet = SpreadsheetApp.openById(spreadsheetId);\r\n    this.sheet = this.spreadsheet.getSheetByName(sheetName);\r\n  }\r\n\r\n  select(headers: string[]): GQueryTableFactory {\r\n    return new GQueryTableFactory(this).select(headers);\r\n  }\r\n\r\n  where(filterFn: (row: any) => boolean): GQueryTableFactory {\r\n    return new GQueryTableFactory(this).where(filterFn);\r\n  }\r\n\r\n  join(\r\n    sheetName: string,\r\n    sheetColumn: string,\r\n    joinColumn: string,\r\n    columnsToReturn?: string[]\r\n  ): GQueryTableFactory {\r\n    return new GQueryTableFactory(this).join(\r\n      sheetName,\r\n      sheetColumn,\r\n      joinColumn,\r\n      columnsToReturn\r\n    );\r\n  }\r\n\r\n  read(): GQueryResult {\r\n    return new GQueryTableFactory(this).get();\r\n  }\r\n}\r\n\r\nclass GQueryTableFactory {\r\n  gQueryTable: GQueryTable;\r\n  selectOption?: string[];\r\n  filterOption?: (row: any) => boolean;\r\n  joinOption: {\r\n    sheetName: string;\r\n    sheetColumn: string;\r\n    joinColumn: string;\r\n    columnsToReturn?: string[];\r\n  }[] = [];\r\n\r\n  constructor(GQueryTable: GQueryTable) {\r\n    this.gQueryTable = GQueryTable;\r\n  }\r\n\r\n  select(headers: string[]): GQueryTableFactory {\r\n    this.selectOption = headers;\r\n    return this;\r\n  }\r\n\r\n  where(filterFn: (row: any) => boolean): GQueryTableFactory {\r\n    this.filterOption = filterFn;\r\n    return this;\r\n  }\r\n\r\n  join(\r\n    sheetName: string,\r\n    sheetColumn: string,\r\n    joinColumn: string,\r\n    columnsToReturn?: string[]\r\n  ): GQueryTableFactory {\r\n    this.joinOption.push({\r\n      sheetName,\r\n      sheetColumn,\r\n      joinColumn,\r\n      columnsToReturn,\r\n    });\r\n    return this;\r\n  }\r\n\r\n  get(): GQueryResult {\r\n    // Get a new GQuery instance to use the readMany method\r\n    const gquery = new GQuery(this.gQueryTable.spreadsheetId);\r\n\r\n    // Determine which sheets we need to read from\r\n    const sheetsToRead = [this.gQueryTable.sheetName];\r\n\r\n    // Add all join sheets\r\n    if (this.joinOption.length > 0) {\r\n      this.joinOption.forEach((join) => {\r\n        if (!sheetsToRead.includes(join.sheetName)) {\r\n          sheetsToRead.push(join.sheetName);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Read data from all required sheets at once\r\n    const results = gquery.getMany(sheetsToRead);\r\n\r\n    // If the main sheet doesn't exist or has no data\r\n    if (\r\n      !results[this.gQueryTable.sheetName] ||\r\n      results[this.gQueryTable.sheetName].rows.length === 0\r\n    ) {\r\n      return { headers: [], rows: [] };\r\n    }\r\n\r\n    // Get data for the primary table\r\n    let result = results[this.gQueryTable.sheetName];\r\n    let rows = result.rows;\r\n    let headers = result.headers;\r\n\r\n    // Process each join sequentially\r\n    if (this.joinOption.length > 0) {\r\n      this.joinOption.forEach((joinConfig) => {\r\n        const { sheetName, sheetColumn, joinColumn, columnsToReturn } =\r\n          joinConfig;\r\n\r\n        const joinData = results[sheetName];\r\n\r\n        if (!joinData || !joinData.rows || joinData.rows.length === 0) {\r\n          return; // Skip this join\r\n        }\r\n\r\n        // Create join lookup table\r\n        const joinMap: Record<string, any[]> = {};\r\n\r\n        // Check if the join column exists in the join table\r\n        const joinHeaders = joinData.headers;\r\n        if (!joinHeaders.includes(sheetColumn)) {\r\n          return; // Skip this join\r\n        }\r\n\r\n        joinData.rows.forEach((joinRow) => {\r\n          const joinKey = String(joinRow[sheetColumn]);\r\n          if (!joinMap[joinKey]) {\r\n            joinMap[joinKey] = [];\r\n          }\r\n          joinMap[joinKey].push(joinRow);\r\n        });\r\n\r\n        // Perform the join operation\r\n        rows = rows.map((row) => {\r\n          const localJoinValue = row[joinColumn];\r\n          const joinedRows = joinMap[String(localJoinValue)] || [];\r\n\r\n          // Create joined row with all join table fields\r\n          const joinedRow = { ...row };\r\n\r\n          joinedRows.forEach((joinRow, index) => {\r\n            // Determine which columns to include from join\r\n            const columnsToInclude =\r\n              columnsToReturn ||\r\n              Object.keys(joinRow).filter(\r\n                (key) => key !== \"__meta\" && key !== sheetColumn\r\n              );\r\n\r\n            columnsToInclude.forEach((key) => {\r\n              if (joinRow.hasOwnProperty(key) && key !== \"__meta\") {\r\n                // For multiple joined rows, add suffix _1, _2, etc.\r\n                const suffix = joinedRows.length > 1 ? `_${index + 1}` : \"\";\r\n                const targetKey = key === sheetColumn ? key : `${key}${suffix}`;\r\n                joinedRow[targetKey] = joinRow[key];\r\n              }\r\n            });\r\n          });\r\n\r\n          return joinedRow;\r\n        });\r\n      });\r\n    }\r\n\r\n    // Apply filter if specified\r\n    if (this.filterOption) {\r\n      rows = rows.filter(this.filterOption);\r\n    }\r\n\r\n    // Apply select if specified\r\n    if (this.selectOption && this.selectOption.length > 0) {\r\n      // Create a map to track columns from joined tables\r\n      const joinedColumns = new Set<string>();\r\n\r\n      // Collect all columns from joined tables\r\n      rows.forEach((row) => {\r\n        Object.keys(row).forEach((key) => {\r\n          // If the column is not in the original headers, it's from a join\r\n          if (!headers.includes(key) && key !== \"__meta\") {\r\n            joinedColumns.add(key);\r\n          }\r\n        });\r\n      });\r\n\r\n      // If we have a select option, determine which columns to keep\r\n      let selectedHeaders: string[];\r\n\r\n      // Check if any of the selected headers is \"Model\" or \"Model_Name\"\r\n      // If we're selecting the join columns, we want to include all related joined fields\r\n      if (\r\n        this.selectOption.some(\r\n          (header) =>\r\n            header === \"Model\" ||\r\n            header === \"Model_Name\" ||\r\n            this.joinOption.some(\r\n              (j) => j.joinColumn === header || j.sheetColumn === header\r\n            )\r\n        )\r\n      ) {\r\n        // Include all join-related columns and the selected columns\r\n        selectedHeaders = [...this.selectOption];\r\n        joinedColumns.forEach((joinCol) => {\r\n          selectedHeaders.push(joinCol);\r\n        });\r\n      } else {\r\n        // Otherwise only include explicitly selected columns\r\n        selectedHeaders = [...this.selectOption];\r\n      }\r\n\r\n      // Remove duplicates\r\n      selectedHeaders = [...new Set(selectedHeaders)];\r\n\r\n      // Filter rows to only include selected columns\r\n      rows = rows.map((row) => {\r\n        const selectedRow: GQueryRow = {\r\n          __meta: row.__meta,\r\n        };\r\n\r\n        selectedHeaders.forEach((header) => {\r\n          if (row.hasOwnProperty(header)) {\r\n            selectedRow[header] = row[header];\r\n          }\r\n        });\r\n\r\n        return selectedRow;\r\n      });\r\n\r\n      // Update headers to include both selected and joined columns\r\n      return {\r\n        headers: selectedHeaders,\r\n        rows,\r\n      };\r\n    }\r\n\r\n    return {\r\n      headers,\r\n      rows,\r\n    };\r\n  }\r\n}\r\n\r\nexport type GQueryReadOptions = {\r\n  valueRenderOption?: ValueRenderOption;\r\n  dateTimeRenderOption?: DateTimeRenderOption;\r\n};\r\nexport type GQueryResult = {\r\n  rows: GQueryRow[];\r\n  headers: string[];\r\n};\r\nexport type GQueryRow = Record<string, any> & {\r\n  __meta: {\r\n    rowNum: number;\r\n    colLength: number;\r\n  };\r\n};\r\nexport enum ValueRenderOption {\r\n  FORMATTED_VALUE = \"FORMATTED_VALUE\",\r\n  UNFORMATTED_VALUE = \"UNFORMATTED_VALUE\",\r\n  FORMULA = \"FORMULA\",\r\n}\r\nexport enum DateTimeRenderOption {\r\n  FORMATTED_STRING = \"FORMATTED_STRING\",\r\n  SERIAL_NUMBER = \"SERIAL_NUMBER\",\r\n}\r\n"],"names":["ValueRenderOption","DateTimeRenderOption"],"mappings":"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"}